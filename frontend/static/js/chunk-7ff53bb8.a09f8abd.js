(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ff53bb8"],{1290:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-form",{attrs:{data:t.globalVar,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"变量类型",rules:[{required:!0}]}},[n("el-input",{staticStyle:{width:"300px"},attrs:{clearable:""},model:{value:t.globalVar.type,callback:function(e){t.$set(t.globalVar,"type","string"===typeof e?e.trim():e)},expression:"globalVar.type"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"变量名",rules:[{required:!0}]}},[n("el-input",{staticStyle:{width:"300px"},attrs:{clearable:""},model:{value:t.globalVar.name,callback:function(e){t.$set(t.globalVar,"name","string"===typeof e?e.trim():e)},expression:"globalVar.name"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"变量值",rules:[{required:!0}]}},t._l(t.globalVar.environmentValues,(function(e,a){return n("el-row",{key:a,staticStyle:{"margin-bottom":"5px"},attrs:{gutter:12}},[n("el-col",{attrs:{span:6}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择环境"},on:{"visible-change":t.envSelectChange},model:{value:e.environmentId,callback:function(n){t.$set(e,"environmentId",n)},expression:"environmentValue.environmentId"}},t._l(t.environmentList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1)],1),t._v(" "),n("el-col",{attrs:{span:12}},[n("el-input",{attrs:{clearable:""},model:{value:e.value,callback:function(n){t.$set(e,"value","string"===typeof n?n.trim():n)},expression:"environmentValue.value"}})],1),t._v(" "),n("el-col",{attrs:{span:5}},[n("el-button",{on:{click:t.addEnvironmentValue}},[t._v("+")]),t._v(" "),n("el-button",{attrs:{disabled:0===a},on:{click:function(e){return t.delEnvironmentValue(a)}}},[t._v("-")])],1)],1)})),1),t._v(" "),n("el-form-item",{attrs:{label:"描述"}},[n("el-input",{staticStyle:{width:"300px"},attrs:{type:"textarea"},model:{value:t.globalVar.description,callback:function(e){t.$set(t.globalVar,"description","string"===typeof e?e.trim():e)},expression:"globalVar.description"}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:t.saveGlobalVar}},[t._v("保 存")])],1)],1)},r=[],l=n("1f53"),i=n("6d17"),o={props:{isAdd:Boolean},data:function(){return{globalVar:{id:void 0,type:"String",name:"",environmentValues:[{environmentId:-1,value:""}],description:"",projectId:this.$store.state.project.id},environmentList:[{id:-1,name:"默认"}]}},created:function(){var t=this;this.fetchEnvironmentList(),this.isAdd||Object(l["c"])({id:this.$route.params.globalVarId}).then((function(e){t.globalVar=e.data[0]}))},methods:{envSelectChange:function(t){t&&this.fetchEnvironmentList()},saveGlobalVarSuccess:function(t){var e=this;this.$notify.success(t),this.$store.dispatch("tagsView/delView",this.$store.state.tagsView.visitedViews.filter((function(t){return t.path===e.$route.path}))[0]),this.$router.back()},saveGlobalVar:function(){var t=this;this.isAdd?Object(l["a"])(this.globalVar).then((function(e){t.saveGlobalVarSuccess(e.msg)})):Object(l["d"])(this.globalVar).then((function(e){t.saveGlobalVarSuccess(e.msg)}))},fetchEnvironmentList:function(){var t=this;Object(i["c"])({projectId:this.$store.state.project.id}).then((function(e){t.environmentList=[{id:-1,name:"默认"}].concat(e.data)}))},addEnvironmentValue:function(){this.globalVar.environmentValues.push({environmentId:void 0,value:""})},delEnvironmentValue:function(t){this.globalVar.environmentValues.splice(t,1)}}},s=o,c=n("2877"),u=Object(c["a"])(s,a,r,!1,null,null,null);e["a"]=u.exports},"1f53":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"d",(function(){return l})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return o}));var a=n("b775");function r(t){return Object(a["a"])({method:"post",url:"/globalVar/add",data:t})}function l(t){return Object(a["a"])({method:"post",url:"/globalVar/update",data:t})}function i(t){return Object(a["a"])({method:"post",url:"/globalVar/list",params:t})}function o(t){return Object(a["a"])({method:"delete",url:"/globalVar/"+t})}},"32b7":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("save-global-var",{attrs:{"is-add":!1}})],1)},r=[],l=n("1290"),i={name:"UpdateGlobalVar",components:{SaveGlobalVar:l["a"]}},o=i,s=n("2877"),c=Object(s["a"])(o,a,r,!1,null,"270e2643",null);e["default"]=c.exports},"6d17":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return l})),n.d(e,"d",(function(){return i})),n.d(e,"c",(function(){return o}));var a=n("b775");function r(t){return Object(a["a"])({method:"post",url:"/environment/add",data:t})}function l(t){return Object(a["a"])({method:"delete",url:"/environment/"+t})}function i(t){return Object(a["a"])({method:"post",url:"/environment/update",data:t})}function o(t){return Object(a["a"])({method:"post",url:"/environment/list",params:t})}}}]);